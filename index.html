<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>LEARN WITH SHAZLY - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© 100%</title>

  <!-- Ø§Ù„Ø®Ø· Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠ -->
  <link href="https://fonts.googleapis.com/css2?family=Scheherazade+New&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg-color: #f0f9f2;
      --text-color: #000;
      --ayah-bg: #e6f4ea;
    }

    body.dark-mode {
      --bg-color: #1a1a1a;
      --text-color: #f0f0f0;
      --ayah-bg: #333;
    }

    body {
      font-family: 'Amiri', serif;
      direction: rtl;
      background: var(--bg-color);
      color: var(--text-color);
      padding: 30px;
      transition: background 0.3s, color 0.3s;
    }

    header {
      background: #4CAF50;
      color: white;
      padding: 30px;
      text-align: center;
      border-radius: 10px;
      margin-bottom: 20px;
    }

    .mode-buttons {
      margin-top: 15px;
    }

    .mode-buttons button {
      margin: 5px;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    select, input, button {
      margin: 10px 0;
      padding: 12px;
      width: 100%;
      max-width: 500px;
      font-size: 18px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }

    button.action-btn {
      background: #4CAF50;
      color: white;
      cursor: pointer;
      border: none;
      transition: 0.3s;
    }

    button.action-btn:hover {
      background: #45a049;
    }

    .ayah {
      background: var(--ayah-bg);
      margin: 20px 0;
      padding: 25px;
      border-radius: 10px;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      flex-wrap: wrap;
    }

    .ayah span {
      flex: 1 1 70%;
      margin-left: 30px;
      font-family: 'Scheherazade New', serif;
      font-size: 40px;
      line-height: 2.2;
      white-space: normal; /* Ù„Ø§ Ù‚Øµ */
      overflow-wrap: break-word; /* ÙŠÙƒØ³Ø± Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ø·ÙˆÙŠÙ„Ø© */
    }

    .controls {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .controls button {
      padding: 10px 20px;
      font-size: 18px;
    }

    audio {
      width: 100%;
      margin-top: 40px;
    }

    section {
      max-width: 900px;
      margin: auto;
    }
  </style>
</head>
<body>

  <header>
    <h1>LEARN WITH SHAZLY</h1>
    <p>Ù†Ø³Ø®Ø© Ø¯Ù‚ÙŠÙ‚Ø© 100% Ù…Ø¹ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ† ÙˆØ§Ù„ÙØ§ØªØ­</p>
    <div class="mode-buttons">
      <button onclick="setMode('dark')">ğŸŒ™ Dark Mode</button>
      <button onclick="setMode('light')">â˜€ï¸ Light Mode</button>
    </div>
  </header>

  <section>
    <h2>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø³ÙˆØ±Ø© ÙˆÙ†Ø·Ø§Ù‚ Ø§Ù„Ø¢ÙŠØ§Øª</h2>
    <select id="surahSelect">
      <option value="">Ø§Ø®ØªØ± Ø³ÙˆØ±Ø©</option>
    </select><br/>

    <label>Ù…Ù† Ø§Ù„Ø¢ÙŠØ©:</label>
    <input type="number" id="fromAyah" min="1" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¢ÙŠØ© Ù…Ù†">

    <label>Ø¥Ù„Ù‰ Ø§Ù„Ø¢ÙŠØ©:</label>
    <input type="number" id="toAyah" min="1" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¢ÙŠØ© Ø¥Ù„Ù‰">

    <button id="loadAyahs" class="action-btn">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¢ÙŠØ§Øª</button>
    <div id="ayahs"></div>
    <audio id="audioPlayer" controls></audio>
  </section>

  <script>
    // âœ… Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø³ÙˆØ±
    const surahNames = [
      "", "Ø§Ù„ÙØ§ØªØ­Ø©", "Ø§Ù„Ø¨Ù‚Ø±Ø©", "Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†", "Ø§Ù„Ù†Ø³Ø§Ø¡", "Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©", "Ø§Ù„Ø£Ù†Ø¹Ø§Ù…", "Ø§Ù„Ø£Ø¹Ø±Ø§Ù", "Ø§Ù„Ø£Ù†ÙØ§Ù„",
      "Ø§Ù„ØªÙˆØ¨Ø©", "ÙŠÙˆÙ†Ø³", "Ù‡ÙˆØ¯", "ÙŠÙˆØ³Ù", "Ø§Ù„Ø±Ø¹Ø¯", "Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…", "Ø§Ù„Ø­Ø¬Ø±", "Ø§Ù„Ù†Ø­Ù„", "Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡",
      "Ø§Ù„ÙƒÙ‡Ù", "Ù…Ø±ÙŠÙ…", "Ø·Ù‡", "Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡", "Ø§Ù„Ø­Ø¬", "Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†", "Ø§Ù„Ù†ÙˆØ±", "Ø§Ù„ÙØ±Ù‚Ø§Ù†", "Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡",
      "Ø§Ù„Ù†Ù…Ù„", "Ø§Ù„Ù‚ØµØµ", "Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª", "Ø§Ù„Ø±ÙˆÙ…", "Ù„Ù‚Ù…Ø§Ù†", "Ø§Ù„Ø³Ø¬Ø¯Ø©", "Ø§Ù„Ø£Ø­Ø²Ø§Ø¨", "Ø³Ø¨Ø£", "ÙØ§Ø·Ø±",
      "ÙŠØ³", "Ø§Ù„ØµØ§ÙØ§Øª", "Øµ", "Ø§Ù„Ø²Ù…Ø±", "ØºØ§ÙØ±", "ÙØµÙ„Øª", "Ø§Ù„Ø´ÙˆØ±Ù‰", "Ø§Ù„Ø²Ø®Ø±Ù", "Ø§Ù„Ø¯Ø®Ø§Ù†", "Ø§Ù„Ø¬Ø§Ø«ÙŠØ©",
      "Ø§Ù„Ø£Ø­Ù‚Ø§Ù", "Ù…Ø­Ù…Ø¯", "Ø§Ù„ÙØªØ­", "Ø§Ù„Ø­Ø¬Ø±Ø§Øª", "Ù‚", "Ø§Ù„Ø°Ø§Ø±ÙŠØ§Øª", "Ø§Ù„Ø·ÙˆØ±", "Ø§Ù„Ù†Ø¬Ù…", "Ø§Ù„Ù‚Ù…Ø±",
      "Ø§Ù„Ø±Ø­Ù…Ù†", "Ø§Ù„ÙˆØ§Ù‚Ø¹Ø©", "Ø§Ù„Ø­Ø¯ÙŠØ¯", "Ø§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø©", "Ø§Ù„Ø­Ø´Ø±", "Ø§Ù„Ù…Ù…ØªØ­Ù†Ø©", "Ø§Ù„ØµÙ", "Ø§Ù„Ø¬Ù…Ø¹Ø©",
      "Ø§Ù„Ù…Ù†Ø§ÙÙ‚ÙˆÙ†", "Ø§Ù„ØªØºØ§Ø¨Ù†", "Ø§Ù„Ø·Ù„Ø§Ù‚", "Ø§Ù„ØªØ­Ø±ÙŠÙ…", "Ø§Ù„Ù…Ù„Ùƒ", "Ø§Ù„Ù‚Ù„Ù…", "Ø§Ù„Ø­Ø§Ù‚Ø©", "Ø§Ù„Ù…Ø¹Ø§Ø±Ø¬",
      "Ù†ÙˆØ­", "Ø§Ù„Ø¬Ù†", "Ø§Ù„Ù…Ø²Ù…Ù„", "Ø§Ù„Ù…Ø¯Ø«Ø±", "Ø§Ù„Ù‚ÙŠØ§Ù…Ø©", "Ø§Ù„Ø¥Ù†Ø³Ø§Ù†", "Ø§Ù„Ù…Ø±Ø³Ù„Ø§Øª", "Ø§Ù„Ù†Ø¨Ø£", "Ø§Ù„Ù†Ø§Ø²Ø¹Ø§Øª",
      "Ø¹Ø¨Ø³", "Ø§Ù„ØªÙƒÙˆÙŠØ±", "Ø§Ù„Ø¥Ù†ÙØ·Ø§Ø±", "Ø§Ù„Ù…Ø·ÙÙÙŠÙ†", "Ø§Ù„Ø¥Ù†Ø´Ù‚Ø§Ù‚", "Ø§Ù„Ø¨Ø±ÙˆØ¬", "Ø§Ù„Ø·Ø§Ø±Ù‚", "Ø§Ù„Ø£Ø¹Ù„Ù‰",
      "Ø§Ù„ØºØ§Ø´ÙŠØ©", "Ø§Ù„ÙØ¬Ø±", "Ø§Ù„Ø¨Ù„Ø¯", "Ø§Ù„Ø´Ù…Ø³", "Ø§Ù„Ù„ÙŠÙ„", "Ø§Ù„Ø¶Ø­Ù‰", "Ø§Ù„Ø´Ø±Ø­", "Ø§Ù„ØªÙŠÙ†", "Ø§Ù„Ø¹Ù„Ù‚",
      "Ø§Ù„Ù‚Ø¯Ø±", "Ø§Ù„Ø¨ÙŠÙ†Ø©", "Ø§Ù„Ø²Ù„Ø²Ù„Ø©", "Ø§Ù„Ø¹Ø§Ø¯ÙŠØ§Øª", "Ø§Ù„Ù‚Ø§Ø±Ø¹Ø©", "Ø§Ù„ØªÙƒØ§Ø«Ø±", "Ø§Ù„Ø¹ØµØ±", "Ø§Ù„Ù‡Ù…Ø²Ø©",
      "Ø§Ù„ÙÙŠÙ„", "Ù‚Ø±ÙŠØ´", "Ø§Ù„Ù…Ø§Ø¹ÙˆÙ†", "Ø§Ù„ÙƒÙˆØ«Ø±", "Ø§Ù„ÙƒØ§ÙØ±ÙˆÙ†", "Ø§Ù„Ù†ØµØ±", "Ø§Ù„Ù…Ø³Ø¯", "Ø§Ù„Ø¥Ø®Ù„Ø§Øµ",
      "Ø§Ù„ÙÙ„Ù‚", "Ø§Ù„Ù†Ø§Ø³"
    ];

    // âœ… Ø¹Ø¯Ø¯ Ø§Ù„Ø¢ÙŠØ§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù„ÙƒÙ„ Ø³ÙˆØ±Ø© (Ø¨Ø¯Ù‚Ø©)
    const surahAyahCounts = [
      0, 7, 286, 200, 176, 120, 165, 206, 75, 129, 109, 123, 111, 43, 52, 99, 128,
      111, 110, 98, 135, 112, 78, 118, 64, 77, 227, 93, 88, 69, 60, 34, 30, 73,
      54, 45, 83, 182, 88, 75, 85, 54, 53, 89, 59, 37, 35, 38, 29, 18, 45, 60,
      49, 62, 55, 78, 96, 29, 22, 24, 13, 14, 11, 11, 18, 12, 12, 30, 52, 52,
      44, 28, 28, 20, 56, 40, 31, 50, 40, 46, 42, 29, 19, 36, 25, 22, 17, 19,
      26, 30, 20, 15, 21, 11, 8, 8, 19, 5, 8, 8, 11, 11, 8, 3, 9, 5, 4, 7, 3,
      6
    ];

    const surahSelect = document.getElementById('surahSelect');
    surahNames.forEach((name, index) => {
      if (index === 0) return;
      const opt = document.createElement('option');
      opt.value = index;
      opt.textContent = `${index}. ${name}`;
      surahSelect.appendChild(opt);
    });

    const fromAyahInput = document.getElementById('fromAyah');
    const toAyahInput = document.getElementById('toAyah');
    const loadAyahsBtn = document.getElementById('loadAyahs');
    const ayahsDiv = document.getElementById('ayahs');
    const audioPlayer = document.getElementById('audioPlayer');

    const partLinks = [
      "https://archive.org/download/1-6-quran-6236-ayah-by--alhosary--morattal---part1",
      "https://archive.org/download/2-6-quran-6236-ayah-by--alhosary--morattal---part2",
      "https://archive.org/download/3-6-quran-6236-ayah-by--alhosary--morattal---part3",
      "https://archive.org/download/4-6-quran-6236-ayah-by--alhosary--morattal---part4",
      "https://archive.org/download/ayaat-koran-5-6-quran-6236-ayah-by--alhosary--morattal____part5",
      "https://archive.org/download/6-6-quran-6236-ayah-by--alhosary--morattal---part6"
    ];

    const partStarts = [1, 1048, 2055, 3111, 4154, 5253];

    let ayahTexts = {};

    fetch('ayahTexts.json')
      .then(res => res.json())
      .then(data => {
        ayahTexts = data;
      })
      .catch(err => {
        console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ ayahTexts.json:", err);
      });

    function getPartIndex(globalID) {
      for (let i = partStarts.length - 1; i >= 0; i--) {
        if (globalID >= partStarts[i]) return i;
      }
      return 0;
    }

    loadAyahsBtn.onclick = () => {
      const surahId = parseInt(surahSelect.value);
      const from = parseInt(fromAyahInput.value);
      const to = parseInt(toAyahInput.value);

      if (!surahId || !from || !to || from > to) {
        alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ­ÙŠØ­Ø©.');
        return;
      }

      ayahsDiv.innerHTML = '';

      for (let i = from; i <= to; i++) {
        // âœ… Ø§Ø­Ø³Ø¨ globalCounter Ø¨Ø¯Ù‚Ø©
        let globalCounter = 0;
        for (let s = 1; s < surahId; s++) {
          globalCounter += surahAyahCounts[s];
        }
        globalCounter += i;

        const surahNum = String(surahId).padStart(3, '0');
        const ayahNum = String(i).padStart(3, '0');
        const fileName = `${surahNum}${ayahNum}.mp3`;
        const partIndex = getPartIndex(globalCounter);
        const audioUrl = `${partLinks[partIndex]}/${fileName}`;

        const div = document.createElement('div');
        div.className = 'ayah';

        const key = `${surahId}:${i}`;
        const text = ayahTexts[key]?.text || `Ø¢ÙŠØ© ${i}`;
        const span = document.createElement('span');
        span.textContent = text;

        const controls = document.createElement('div');
        controls.className = 'controls';

        const playBtn = document.createElement('button');
        playBtn.textContent = 'â–¶ï¸ ØªØ´ØºÙŠÙ„';
        playBtn.onclick = () => {
          audioPlayer.src = audioUrl;
          audioPlayer.play();
        };

        const stopBtn = document.createElement('button');
        stopBtn.textContent = 'â¹ï¸ Ø¥ÙŠÙ‚Ø§Ù';
        stopBtn.onclick = () => {
          audioPlayer.pause();
        };

        controls.appendChild(playBtn);
        controls.appendChild(stopBtn);

        div.appendChild(span);
        div.appendChild(controls);
        ayahsDiv.appendChild(div);
      }
    };

    [surahSelect, fromAyahInput, toAyahInput, loadAyahsBtn].forEach((el, idx, arr) => {
      el.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          e.preventDefault();
          const next = arr[idx + 1];
          if (next) next.focus();
        }
      });
    });

    function setMode(mode) {
      if (mode === 'dark') {
        document.body.classList.add('dark-mode');
      } else {
        document.body.classList.remove('dark-mode');
      }
    }
  </script>

</body>
</html>
